# FlowSlide 环境配置文件示例
# 复制此文件为 .env 并填入实际值

# ======================
# 数据库配置
# ======================
# 数据库模式: local(本地优先), external(外部优先), hybrid(混合模式)
# local: 优先使用本地SQLite，外部数据库作为备份
# external: 直接使用外部数据库
# hybrid: 本地和外部数据库同时使用，支持实时同步
DATABASE_MODE=local

# 外部数据库连接 URL (可选)
# 如果设置了此项，将启用数据同步功能
DATABASE_URL=postgresql://username:password@host:port/database?sslmode=require&options=-c%20search_path%3Dschema,public

# 或者使用分离的配置
DB_HOST=localhost
DB_PORT=your-database-port
DB_NAME=your_database_name
DB_USER=your_db_user
DB_PASSWORD=your_secure_password

# 数据同步配置
# 是否启用自动同步到外部数据库
ENABLE_DATA_SYNC=true

# 同步间隔 (秒)
SYNC_INTERVAL=300

# 同步模式: full(全量), incremental(增量)
SYNC_MODE=incremental

# 默认管理员（首次启动自动创建）
# 推荐使用新变量名，兼容旧的 ADMIN_USERNAME
ADMIN_NAME=admin
ADMIN_PASSWORD=admin123456
ADMIN_EMAIL=

# ======================
# API 配置（可选，用于 REST API 测试）
# ======================
# 示例：Supabase 配置
API_URL=https://your-api-endpoint.example.com
API_ANON_KEY=your-anon-key
API_SERVICE_KEY=your-service-key

# 示例：其他 PostgreSQL 服务（如果有 API）
# API_URL=https://your-api-endpoint.com
# API_ANON_KEY=your-api-key
# API_SERVICE_KEY=your-service-key

# ======================
# 存储配置（可选）
# ======================
STORAGE_BUCKET=your-storage-bucket-name
STORAGE_PROVIDER=supabase

# ======================
# Cloudflare R2 备份配置
# ======================
# R2 访问密钥 ID
R2_ACCESS_KEY_ID=your_r2_access_key_id

# R2 秘密访问密钥
R2_SECRET_ACCESS_KEY=your_r2_secret_access_key

# R2 端点 URL
R2_ENDPOINT=https://<accountid>.r2.cloudflarestorage.com

# R2 存储桶名称
R2_BUCKET_NAME=flowslide-backup

# ======================
# 备份配置
# ======================
# 备份调度 (cron 格式)
# 默认: 每天凌晨 2 点
BACKUP_SCHEDULE=0 2 * * *

# 备份保留天数
BACKUP_RETENTION_DAYS=30

# 备份完成通知 Webhook URL (可选)
# 支持 Slack, Discord, 企业微信等
BACKUP_WEBHOOK_URL=

# ======================
# 健康检查配置
# ======================
# 是否跳过数据库检查
SKIP_DB_CHECK=false

# 是否要求数据库连接
REQUIRE_DB=true

# 是否运行数据库模式检查
RUN_DB_SCHEMA_CHECK=true

# ======================
# 性能配置
# ======================
# 最大工作进程数
MAX_WORKERS=4

# 请求超时时间 (秒)
REQUEST_TIMEOUT=30

# 数据库连接池大小
DB_POOL_SIZE=10

# ======================
# 应用配置
# ======================
# 应用端口
PORT=8000

# 调试模式
DEBUG=false

# 日志级别 (DEBUG, INFO, WARNING, ERROR)
LOG_LEVEL=INFO

# 临时文件清理间隔 (小时)
TEMP_CLEANUP_INTERVAL=24

# ======================
# 安全配置
# ======================
# JWT 密钥 (用于会话管理)
JWT_SECRET=your_jwt_secret_key

# API 速率限制 (每分钟请求数)
API_RATE_LIMIT=100

# 允许的文件上传大小 (MB)
MAX_UPLOAD_SIZE=50
# 或使用字节数（高优先级）
# MAX_FILE_SIZE=52428800
# 兼容旧变量名（MB）
# MAX_FILE_SIZE_MB=50

# 登录页验证码（可选，建议开启以防止爆破）
ENABLE_LOGIN_CAPTCHA=false
# Cloudflare Turnstile（推荐）
TURNSTILE_SITE_KEY=
TURNSTILE_SECRET_KEY=
# 或使用 hCaptcha
HCAPTCHA_SITE_KEY=
HCAPTCHA_SECRET_KEY=

# ======================
# 邮件配置 (可选)
# ======================
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_USE_TLS=true

# ======================
# 监控配置 (可选)
# ======================
# Prometheus 指标端点
METRICS_ENABLED=false
METRICS_PORT=9090

# 健康检查端点
HEALTH_CHECK_ENDPOINT=/health

# ======================
# Redis 配置 (可选 - 用于缓存)
# ======================
REDIS_URL=redis://localhost:6379/0
REDIS_ENABLED=false

# ======================
# 开发配置
# ======================
# 开发模式热重载
DEV_RELOAD=false

# 开发服务器主机
DEV_HOST=0.0.0.0

# 允许的主机名 (逗号分隔)
ALLOWED_HOSTS=localhost,127.0.0.1
